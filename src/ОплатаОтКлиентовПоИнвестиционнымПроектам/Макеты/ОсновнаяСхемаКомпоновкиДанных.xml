<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>АналитикаУчетаПоПартнерам</dataPath>
				<field>АналитикаУчетаПоПартнерам</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Аналитика реализации</d5p1:content>
					</d5p1:item>
				</title>
				<appearance/>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Реализация</dataPath>
				<field>Реализация</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Реализация</d5p1:content>
					</d5p1:item>
				</title>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
				<appearance/>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДатаОплатыПланПоРеализации</dataPath>
				<field>ДатаОплатыПланПоРеализации</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Дата оплаты (план)</d5p1:content>
					</d5p1:item>
				</title>
				<appearance/>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаОплаченоПоРеализации</dataPath>
				<field>СуммаОплаченоПоРеализации</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Сумма оплаты по реализации</d5p1:content>
					</d5p1:item>
				</title>
				<valueType>
					<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:decimal</Type>
					<NumberQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
						<Digits>64</Digits>
						<FractionDigits>2</FractionDigits>
						<AllowedSign>Any</AllowedSign>
					</NumberQualifiers>
				</valueType>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/core" xsi:type="d7p1:LocalStringType">
							<d7p1:item>
								<d7p1:lang>ru</d7p1:lang>
								<d7p1:content>ЧДЦ=2</d7p1:content>
							</d7p1:item>
						</value>
					</item>
				</appearance>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаВыручкиПоПартии</dataPath>
				<field>СуммаВыручкиПоПартии</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Выручка</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/core" xsi:type="d7p1:LocalStringType">
							<d7p1:item>
								<d7p1:lang>ru</d7p1:lang>
								<d7p1:content>ЧДЦ=2</d7p1:content>
							</d7p1:item>
						</value>
					</item>
				</appearance>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаДокументаРеализации</dataPath>
				<field>СуммаДокументаРеализации</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Сумма документа реализации</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/core" xsi:type="d7p1:LocalStringType">
							<d7p1:item>
								<d7p1:lang>ru</d7p1:lang>
								<d7p1:content>ЧДЦ=2</d7p1:content>
							</d7p1:item>
						</value>
					</item>
				</appearance>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ПериодРеализации</dataPath>
				<field>ПериодРеализации</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Дата продажи</d5p1:content>
					</d5p1:item>
				</title>
				<valueType>
					<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
					<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
						<DateFractions>DateTime</DateFractions>
					</DateQualifiers>
				</valueType>
				<appearance/>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Партия</dataPath>
				<field>Партия</field>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
				<appearance/>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ДоляОплаченоПоРеализации</dataPath>
				<field>ДоляОплаченоПоРеализации</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Процент оплаты по реализации</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/core" xsi:type="d7p1:LocalStringType">
							<d7p1:item>
								<d7p1:lang>ru</d7p1:lang>
								<d7p1:content>ЧДЦ=</d7p1:content>
							</d7p1:item>
						</value>
					</item>
				</appearance>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаОплаченоПоПартии</dataPath>
				<field>СуммаОплаченоПоПартии</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Сумма оплаты</d5p1:content>
					</d5p1:item>
				</title>
				<valueType>
					<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:decimal</Type>
					<NumberQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
						<Digits>18</Digits>
						<FractionDigits>2</FractionDigits>
						<AllowedSign>Any</AllowedSign>
					</NumberQualifiers>
				</valueType>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/core" xsi:type="d7p1:LocalStringType">
							<d7p1:item>
								<d7p1:lang>ru</d7p1:lang>
								<d7p1:content>ЧДЦ=2</d7p1:content>
							</d7p1:item>
						</value>
					</item>
				</appearance>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Номенклатура</d5p1:content>
					</d5p1:item>
				</title>
				<appearance/>
				<inputParameters/>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СебестоимостьПоПартии</dataPath>
				<field>СебестоимостьПоПартии</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Стоимость</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/core" xsi:type="d7p1:LocalStringType">
							<d7p1:item>
								<d7p1:lang>ru</d7p1:lang>
								<d7p1:content>ЧДЦ=2</d7p1:content>
							</d7p1:item>
						</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Поставщик</dataPath>
				<field>Поставщик</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Поставщик</d5p1:content>
					</d5p1:item>
				</title>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
					<parentDimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">Партия</parentDimension>
				</role>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>СуммаПоставки</dataPath>
				<field>СуммаПоставки</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Сумма поставки</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/core" xsi:type="d7p1:LocalStringType">
							<d7p1:item>
								<d7p1:lang>ru</d7p1:lang>
								<d7p1:content>ЧДЦ=2</d7p1:content>
							</d7p1:item>
						</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>ИнвестиционныйПроект</dataPath>
				<field>ИнвестиционныйПроект</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Инвестиционный проект</d5p1:content>
					</d5p1:item>
				</title>
				<role>
					<dimension xmlns="http://v8.1c.ru/8.1/data-composition-system/common">true</dimension>
				</role>
				<valueType>
					<TypeId xmlns="http://v8.1c.ru/8.1/data/core">e43b25dc-c8ff-4d76-bc32-fbe9644fb6e8</TypeId>
				</valueType>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>КоличествоПоПартии</dataPath>
				<field>КоличествоПоПартии</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Количество</d5p1:content>
					</d5p1:item>
				</title>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>АналитикаУчетаНоменклатуры</dataPath>
				<field>АналитикаУчетаНоменклатуры</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ПоступленияИАвансы.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	СУММА(ПоступленияИАвансы.СуммаОплаты) КАК Оплата
ПОМЕСТИТЬ втПоступлениеДенег
ИЗ
	(ВЫБРАТЬ
		Обороты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
		-Обороты.СуммаОборот КАК СуммаОплаты
	ИЗ
		РегистрНакопления.РасчетыСКлиентами.Обороты(&amp;Дата1, &amp;Дата2, Регистратор, {(АналитикаУчетаПоПартнерам).* КАК АналитикаУчетаПоПартнерам}) КАК Обороты
	ГДЕ
		НЕ Обороты.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента
		И Обороты.СуммаОборот &lt; 0
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		РасчетыСКлиентамиОстатки.АналитикаУчетаПоПартнерам,
		-СУММА(РасчетыСКлиентамиОстатки.СуммаОстаток)
	ИЗ
		РегистрНакопления.РасчетыСКлиентами.Остатки(&amp;Дата1, {(АналитикаУчетаПоПартнерам).* КАК АналитикаУчетаПоПартнерам}) КАК РасчетыСКлиентамиОстатки
	
	СГРУППИРОВАТЬ ПО
		РасчетыСКлиентамиОстатки.АналитикаУчетаПоПартнерам
	
	ИМЕЮЩИЕ
		СУММА(РасчетыСКлиентамиОстатки.СуммаОстаток) &lt; 0) КАК ПоступленияИАвансы

СГРУППИРОВАТЬ ПО
	ПоступленияИАвансы.АналитикаУчетаПоПартнерам

ИМЕЮЩИЕ
	СУММА(ПоступленияИАвансы.СуммаОплаты) &gt; 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Остатки.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Остатки.СуммаОстаток КАК Долг
ПОМЕСТИТЬ втДолги
ИЗ
	РегистрНакопления.РасчетыСКлиентами.Остатки(ДОБАВИТЬКДАТЕ(&amp;Дата2, СЕКУНДА, 1), ) КАК Остатки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втПоступлениеДенег КАК втПоступлениеДенег
		ПО Остатки.АналитикаУчетаПоПартнерам = втПоступлениеДенег.АналитикаУчетаПоПартнерам
ГДЕ
	Остатки.СуммаОстаток &gt; 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ПоступленияИДолги.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	&amp;Дата2 КАК Край,
	0 КАК ПолуСумма,
	0 КАК Сдвиг,
	СУММА(ПоступленияИДолги.Сумма) КАК Долг
ПОМЕСТИТЬ Шаг_536870912
ИЗ
	(ВЫБРАТЬ
		втПоступлениеДенег.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
		втПоступлениеДенег.Оплата КАК Сумма
	ИЗ
		втПоступлениеДенег КАК втПоступлениеДенег
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		втДолги.АналитикаУчетаПоПартнерам,
		втДолги.Долг
	ИЗ
		втДолги КАК втДолги) КАК ПоступленияИДолги

СГРУППИРОВАТЬ ПО
	ПоступленияИДолги.АналитикаУчетаПоПартнерам
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Обороты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Обороты.ЗаказКлиента КАК ЗаказКлиента,
	Обороты.Валюта КАК Валюта,
	ВЫРАЗИТЬ(Обороты.Регистратор КАК Документ.ВозвратТоваровОтКлиента).ДокументРеализации КАК Реализация,
	СУММА(-Обороты.СуммаОборот) КАК СуммаВозврата
ПОМЕСТИТЬ ОборотыПоВозвратам
ИЗ
	РегистрНакопления.РасчетыСКлиентами.Обороты(
			,
			&amp;Дата2,
			Регистратор,
			АналитикаУчетаПоПартнерам В
				(ВЫБРАТЬ
					Шаг.АналитикаУчетаПоПартнерам
				ИЗ
					втПоступлениеДенег КАК Шаг)) КАК Обороты
ГДЕ
	Обороты.СуммаОборот &lt; 0
	И Обороты.Регистратор ССЫЛКА Документ.ВозвратТоваровОтКлиента

СГРУППИРОВАТЬ ПО
	ВЫРАЗИТЬ(Обороты.Регистратор КАК Документ.ВозвратТоваровОтКлиента).ДокументРеализации,
	Обороты.ЗаказКлиента,
	Обороты.Валюта,
	Обороты.АналитикаУчетаПоПартнерам
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Обороты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Обороты.ЗаказКлиента КАК ЗаказКлиента,
	Обороты.Валюта КАК Валюта,
	Обороты.Период КАК Период,
	Обороты.Регистратор КАК Регистратор,
	Обороты.СуммаОборот - ЕСТЬNULL(ОборотыПоВозвратам.СуммаВозврата, 0) КАК СуммаОборот
ПОМЕСТИТЬ ОборотыРазвернуто
ИЗ
	РегистрНакопления.РасчетыСКлиентами.Обороты(
			,
			&amp;Дата2,
			Регистратор,
			АналитикаУчетаПоПартнерам В
				(ВЫБРАТЬ
					Шаг.АналитикаУчетаПоПартнерам
				ИЗ
					втПоступлениеДенег КАК Шаг)) КАК Обороты
		ЛЕВОЕ СОЕДИНЕНИЕ ОборотыПоВозвратам КАК ОборотыПоВозвратам
		ПО Обороты.АналитикаУчетаПоПартнерам = ОборотыПоВозвратам.АналитикаУчетаПоПартнерам
			И Обороты.ЗаказКлиента = ОборотыПоВозвратам.ЗаказКлиента
			И Обороты.Валюта = ОборотыПоВозвратам.Валюта
			И Обороты.Регистратор = ОборотыПоВозвратам.Реализация
ГДЕ
	Обороты.СуммаОборот - ЕСТЬNULL(ОборотыПоВозвратам.СуммаВозврата, 0) &gt; 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Обороты.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Обороты.Период КАК Период,
	СУММА(Обороты.СуммаОборот) КАК СуммаОборот
ПОМЕСТИТЬ Обороты
ИЗ
	ОборотыРазвернуто КАК Обороты

СГРУППИРОВАТЬ ПО
	Обороты.АналитикаУчетаПоПартнерам,
	Обороты.Период

ИНДЕКСИРОВАТЬ ПО
	Обороты.АналитикаУчетаПоПартнерам,
	Обороты.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Шаг.Край КАК Край,
	Шаг.Долг КАК Долг,
	ЕСТЬNULL(СУММА(Обороты.СуммаОборот), 0) КАК ПолуСумма,
	ВЫБОР
		КОГДА Шаг.Долг &gt; ЕСТЬNULL(СУММА(Обороты.СуммаОборот), 0)
			ТОГДА -1
		ИНАЧЕ 0
	КОНЕЦ КАК Сдвиг
ПОМЕСТИТЬ Шаг_1
ИЗ
	(ВЫБРАТЬ
		Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
		Шаг.Долг + Шаг.Сдвиг * Шаг.ПолуСумма КАК Долг,
		ДОБАВИТЬКДАТЕ(Шаг.Край, СЕКУНДА, 536870912 * (Шаг.Сдвиг - 0.5) + 1) КАК Центр,
		ДОБАВИТЬКДАТЕ(Шаг.Край, СЕКУНДА, 536870912 * Шаг.Сдвиг) КАК Край
	ИЗ
		Шаг_536870912 КАК Шаг) КАК Шаг
		ЛЕВОЕ СОЕДИНЕНИЕ Обороты КАК Обороты
		ПО Шаг.АналитикаУчетаПоПартнерам = Обороты.АналитикаУчетаПоПартнерам
			И (Обороты.Период МЕЖДУ Шаг.Центр И Шаг.Край)

СГРУППИРОВАТЬ ПО
	Шаг.АналитикаУчетаПоПартнерам,
	Шаг.Край,
	Шаг.Долг
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Шаг.Край КАК Край,
	Шаг.Долг КАК Долг,
	ЕСТЬNULL(СУММА(Обороты.СуммаОборот), 0) КАК Сумма
ПОМЕСТИТЬ Шаг_0
ИЗ
	(ВЫБРАТЬ
		Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
		Шаг.Долг + Шаг.Сдвиг * Шаг.ПолуСумма КАК Долг,
		ДОБАВИТЬКДАТЕ(Шаг.Край, СЕКУНДА, Шаг.Сдвиг) КАК Край
	ИЗ
		Шаг_1 КАК Шаг) КАК Шаг
		ЛЕВОЕ СОЕДИНЕНИЕ Обороты КАК Обороты
		ПО Шаг.АналитикаУчетаПоПартнерам = Обороты.АналитикаУчетаПоПартнерам
			И (Обороты.Период = Шаг.Край)

СГРУППИРОВАТЬ ПО
	Шаг.АналитикаУчетаПоПартнерам,
	Шаг.Край,
	Шаг.Долг
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Обороты.Период КАК Период,
	Обороты.Регистратор КАК Регистратор,
	ВЫБОР
		КОГДА Обороты.Период = Шаг.Край
			ТОГДА Шаг.Долг * Обороты.СуммаОборот / Шаг.Сумма
		ИНАЧЕ Обороты.СуммаОборот
	КОНЕЦ КАК ДолгИлиОплата,
	РАЗНОСТЬДАТ(Обороты.Период, &amp;Дата2, ДЕНЬ) КАК Долгота
ПОМЕСТИТЬ втНеоплаченныеИОплаченные
ИЗ
	Шаг_0 КАК Шаг
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыРазвернуто КАК Обороты
		ПО Шаг.АналитикаУчетаПоПартнерам = Обороты.АналитикаУчетаПоПартнерам
			И Шаг.Край &lt;= Обороты.Период
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Остатки.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	&amp;Дата2 КАК Край,
	Остатки.Долг КАК Долг,
	0 КАК ПолуСумма,
	0 КАК Сдвиг
ПОМЕСТИТЬ ДопШаг_536870912
ИЗ
	втДолги КАК Остатки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Шаг.Край КАК Край,
	Шаг.Долг КАК Долг,
	ЕСТЬNULL(СУММА(Обороты.СуммаОборот), 0) КАК ПолуСумма,
	ВЫБОР
		КОГДА Шаг.Долг &gt; ЕСТЬNULL(СУММА(Обороты.СуммаОборот), 0)
			ТОГДА -1
		ИНАЧЕ 0
	КОНЕЦ КАК Сдвиг
ПОМЕСТИТЬ ДопШаг_1
ИЗ
	(ВЫБРАТЬ
		Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
		Шаг.Долг + Шаг.Сдвиг * Шаг.ПолуСумма КАК Долг,
		ДОБАВИТЬКДАТЕ(Шаг.Край, СЕКУНДА, 536870912 * (Шаг.Сдвиг - 0.5) + 1) КАК Центр,
		ДОБАВИТЬКДАТЕ(Шаг.Край, СЕКУНДА, 536870912 * Шаг.Сдвиг) КАК Край
	ИЗ
		ДопШаг_536870912 КАК Шаг) КАК Шаг
		ЛЕВОЕ СОЕДИНЕНИЕ Обороты КАК Обороты
		ПО Шаг.АналитикаУчетаПоПартнерам = Обороты.АналитикаУчетаПоПартнерам
			И (Обороты.Период МЕЖДУ Шаг.Центр И Шаг.Край)

СГРУППИРОВАТЬ ПО
	Шаг.АналитикаУчетаПоПартнерам,
	Шаг.Край,
	Шаг.Долг
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Шаг.Край КАК Край,
	Шаг.Долг КАК Долг,
	ЕСТЬNULL(СУММА(Обороты.СуммаОборот), 0) КАК Сумма
ПОМЕСТИТЬ ДопШаг_0
ИЗ
	(ВЫБРАТЬ
		Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
		Шаг.Долг + Шаг.Сдвиг * Шаг.ПолуСумма КАК Долг,
		ДОБАВИТЬКДАТЕ(Шаг.Край, СЕКУНДА, Шаг.Сдвиг) КАК Край
	ИЗ
		ДопШаг_1 КАК Шаг) КАК Шаг
		ЛЕВОЕ СОЕДИНЕНИЕ Обороты КАК Обороты
		ПО Шаг.АналитикаУчетаПоПартнерам = Обороты.АналитикаУчетаПоПартнерам
			И (Обороты.Период = Шаг.Край)

СГРУППИРОВАТЬ ПО
	Шаг.АналитикаУчетаПоПартнерам,
	Шаг.Край,
	Шаг.Долг
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Шаг.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	Обороты.Период КАК Период,
	Обороты.Регистратор КАК Регистратор,
	ВЫБОР
		КОГДА Обороты.Период = Шаг.Край
			ТОГДА Шаг.Долг * Обороты.СуммаОборот / Шаг.Сумма
		ИНАЧЕ Обороты.СуммаОборот
	КОНЕЦ КАК Долг,
	РАЗНОСТЬДАТ(Обороты.Период, &amp;Дата2, ДЕНЬ) КАК Долгота
ПОМЕСТИТЬ втНеоплаченные
ИЗ
	ДопШаг_0 КАК Шаг
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ОборотыРазвернуто КАК Обороты
		ПО Шаг.АналитикаУчетаПоПартнерам = Обороты.АналитикаУчетаПоПартнерам
			И Шаг.Край &lt;= Обороты.Период
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ОборотыРазвернуто
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	втНеоплаченныеИОплаченные.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	ВЫРАЗИТЬ(втНеоплаченныеИОплаченные.Регистратор КАК Документ.РеализацияТоваровУслуг) КАК Реализация,
	ВЫРАЗИТЬ(втНеоплаченныеИОплаченные.Регистратор КАК Документ.РеализацияТоваровУслуг).СуммаДокумента КАК СуммаДокумента,
	втНеоплаченныеИОплаченные.Период КАК Период,
	втНеоплаченныеИОплаченные.ДолгИлиОплата - ЕСТЬNULL(втНеоплаченные.Долг, 0) КАК СуммаОплачено
ПОМЕСТИТЬ втСписокРеализаций
ИЗ
	втНеоплаченныеИОплаченные КАК втНеоплаченныеИОплаченные
		ЛЕВОЕ СОЕДИНЕНИЕ втНеоплаченные КАК втНеоплаченные
		ПО втНеоплаченныеИОплаченные.АналитикаУчетаПоПартнерам = втНеоплаченные.АналитикаУчетаПоПартнерам
			И втНеоплаченныеИОплаченные.Регистратор = втНеоплаченные.Регистратор
ГДЕ
	втНеоплаченныеИОплаченные.ДолгИлиОплата &lt;&gt; ЕСТЬNULL(втНеоплаченные.Долг, 0)
	И втНеоплаченныеИОплаченные.Регистратор ССЫЛКА Документ.РеализацияТоваровУслуг
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втНеоплаченныеИОплаченные
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	втСписокРеализаций.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	втСписокРеализаций.Реализация КАК Реализация,
	втСписокРеализаций.СуммаДокумента КАК СуммаДокумента,
	втСписокРеализаций.Период КАК Период,
	втСписокРеализаций.СуммаОплачено КАК СуммаОплачено,
	ВЫБОР
		КОГДА &amp;ИспользоватьГрафикОплатыИзСоглашенияСКлиентом
			ТОГДА ВЫБОР
					КОГДА втСписокРеализаций.Реализация.Соглашение.ГрафикОплаты = &amp;ГрафикНеЗаполнен
						ТОГДА втСписокРеализаций.Реализация.ЗаказКлиента
					ИНАЧЕ втСписокРеализаций.Реализация.Соглашение.ГрафикОплаты
				КОНЕЦ
		ИНАЧЕ втСписокРеализаций.Реализация.ЗаказКлиента
	КОНЕЦ КАК ГрафикПоСоглашениюИлиЗаказ,
	ВЫБОР
		КОГДА втСписокРеализаций.Реализация.РеализацияПоЗаказам = ЛОЖЬ
			ТОГДА втСписокРеализаций.Реализация.ДатаПлатежа
		КОГДА втСписокРеализаций.Реализация.ПорядокРасчетов = &amp;ПоНакладным
			ТОГДА втСписокРеализаций.Реализация.ДатаПлатежа
		КОГДА ВЫРАЗИТЬ(втСписокРеализаций.Реализация.ЗаказКлиента КАК Документ.ЗаказКлиента).ПорядокРасчетов = &amp;ПоНакладным
			ТОГДА втСписокРеализаций.Реализация.ДатаПлатежа
		ИНАЧЕ ДАТАВРЕМЯ(1, 1, 1)
	КОНЕЦ КАК ДатаПлатежа
ПОМЕСТИТЬ втРеализацииБезРазбиенияНаЭтапыОплат
ИЗ
	втСписокРеализаций КАК втСписокРеализаций
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втСписокРеализаций
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	втРеализацииБезРазбиенияНаЭтапыОплат.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	втРеализацииБезРазбиенияНаЭтапыОплат.Реализация КАК Реализация,
	втРеализацииБезРазбиенияНаЭтапыОплат.СуммаДокумента КАК СуммаДокумента,
	втРеализацииБезРазбиенияНаЭтапыОплат.Период КАК Период,
	втРеализацииБезРазбиенияНаЭтапыОплат.СуммаОплачено КАК СуммаОплачено,
	ЕСТЬNULL(ЭтапыГрафикаОплатыПоЗаказу.ДатаПлатежа, втРеализацииБезРазбиенияНаЭтапыОплат.ДатаПлатежа) КАК ДатаПлатежа,
	ВЫБОР
		КОГДА ЕСТЬNULL(ЭтапыГрафикаОплаты.ВариантОплаты, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(Перечисление.ВариантыОплатыКлиентом.КредитПослеОтгрузки)
			ТОГДА ЕСТЬNULL(ЭтапыГрафикаОплаты.Сдвиг, 0)
		ИНАЧЕ 0
	КОНЕЦ КАК Сдвиг,
	ВЫБОР
		КОГДА ЕСТЬNULL(ЭтапыГрафикаОплатыПоЗаказу.ДатаПлатежа, втРеализацииБезРазбиенияНаЭтапыОплат.ДатаПлатежа) &gt; ДАТАВРЕМЯ(1, 1, 1)
			ТОГДА НЕОПРЕДЕЛЕНО
		ИНАЧЕ ВЫРАЗИТЬ(втРеализацииБезРазбиенияНаЭтапыОплат.ГрафикПоСоглашениюИлиЗаказ КАК Справочник.ГрафикиОплаты).Календарь
	КОНЕЦ КАК Календарь,
	СУММА(втРеализацииБезРазбиенияНаЭтапыОплат.СуммаДокумента * ЕСТЬNULL(ЭтапыГрафикаОплаты.ПроцентПлатежа, 100) / 100 * ЕСТЬNULL(ЭтапыГрафикаОплатыПоЗаказу.ПроцентПлатежа, 100) / 100) КАК СуммаЭтапа
ПОМЕСТИТЬ втРеализацииСоСдвигом
ИЗ
	втРеализацииБезРазбиенияНаЭтапыОплат КАК втРеализацииБезРазбиенияНаЭтапыОплат
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГрафикиОплаты.Этапы КАК ЭтапыГрафикаОплаты
		ПО втРеализацииБезРазбиенияНаЭтапыОплат.ГрафикПоСоглашениюИлиЗаказ = ЭтапыГрафикаОплаты.Ссылка
			И (втРеализацииБезРазбиенияНаЭтапыОплат.ДатаПлатежа = ДАТАВРЕМЯ(1, 1, 1))
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ЗаказКлиента.ЭтапыГрафикаОплаты КАК ЭтапыГрафикаОплатыПоЗаказу
		ПО втРеализацииБезРазбиенияНаЭтапыОплат.ГрафикПоСоглашениюИлиЗаказ = ЭтапыГрафикаОплатыПоЗаказу.Ссылка
			И (втРеализацииБезРазбиенияНаЭтапыОплат.ДатаПлатежа = ДАТАВРЕМЯ(1, 1, 1))

СГРУППИРОВАТЬ ПО
	втРеализацииБезРазбиенияНаЭтапыОплат.АналитикаУчетаПоПартнерам,
	втРеализацииБезРазбиенияНаЭтапыОплат.Реализация,
	втРеализацииБезРазбиенияНаЭтапыОплат.Период,
	ЕСТЬNULL(ЭтапыГрафикаОплатыПоЗаказу.ДатаПлатежа, втРеализацииБезРазбиенияНаЭтапыОплат.ДатаПлатежа),
	ВЫБОР
		КОГДА ЕСТЬNULL(ЭтапыГрафикаОплатыПоЗаказу.ДатаПлатежа, втРеализацииБезРазбиенияНаЭтапыОплат.ДатаПлатежа) &gt; ДАТАВРЕМЯ(1, 1, 1)
			ТОГДА НЕОПРЕДЕЛЕНО
		ИНАЧЕ ВЫРАЗИТЬ(втРеализацииБезРазбиенияНаЭтапыОплат.ГрафикПоСоглашениюИлиЗаказ КАК Справочник.ГрафикиОплаты).Календарь
	КОНЕЦ,
	втРеализацииБезРазбиенияНаЭтапыОплат.СуммаДокумента,
	втРеализацииБезРазбиенияНаЭтапыОплат.СуммаОплачено,
	ВЫБОР
		КОГДА ЕСТЬNULL(ЭтапыГрафикаОплаты.ВариантОплаты, НЕОПРЕДЕЛЕНО) = ЗНАЧЕНИЕ(Перечисление.ВариантыОплатыКлиентом.КредитПослеОтгрузки)
			ТОГДА ЕСТЬNULL(ЭтапыГрафикаОплаты.Сдвиг, 0)
		ИНАЧЕ 0
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втРеализацииБезРазбиенияНаЭтапыОплат
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	втРеализацииСоСдвигом.Период КАК Период,
	втРеализацииСоСдвигом.Календарь КАК Календарь
ПОМЕСТИТЬ втКалендари
ИЗ
	втРеализацииСоСдвигом КАК втРеализацииСоСдвигом
ГДЕ
	втРеализацииСоСдвигом.Календарь &lt;&gt; НЕОПРЕДЕЛЕНО
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	втКалендари.Период КАК ДатаНачала,
	втКалендари.Календарь КАК Календарь,
	ГрафикиРаботы.Дата КАК ДатаОкончания,
	ВЫБОР
		КОГДА ГрафикиРаботы.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Рабочий)
				ИЛИ ГрафикиРаботы.ВидДня = ЗНАЧЕНИЕ(Перечисление.ВидыДнейПроизводственногоКалендаря.Предпраздничный)
			ТОГДА 1
		ИНАЧЕ 0
	КОНЕЦ КАК РабочийДень
ПОМЕСТИТЬ втГрафики
ИЗ
	втКалендари КАК втКалендари
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ДанныеПроизводственногоКалендаря КАК ГрафикиРаботы
		ПО втКалендари.Календарь = ГрафикиРаботы.ПроизводственныйКалендарь
ГДЕ
	ГрафикиРаботы.Дата &gt;= втКалендари.Период
	И втКалендари.Период &lt;&gt; ДАТАВРЕМЯ(1, 1, 1)
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втКалендари
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	ВложенныйЗапрос.Календарь КАК Календарь,
	ВложенныйЗапрос.ДатаНачала КАК ДатаНачала,
	ВложенныйЗапрос.ДатаОкончания КАК ДатаОкончания,
	ЕСТЬNULL(СУММА(Графики.РабочийДень), 0) КАК КоличествоДней
ПОМЕСТИТЬ втРазностиДат
ИЗ
	втГрафики КАК ВложенныйЗапрос
		ЛЕВОЕ СОЕДИНЕНИЕ втГрафики КАК Графики
		ПО ВложенныйЗапрос.Календарь = Графики.Календарь
			И ВложенныйЗапрос.ДатаНачала = Графики.ДатаНачала
			И ВложенныйЗапрос.ДатаОкончания &gt; Графики.ДатаОкончания

СГРУППИРОВАТЬ ПО
	ВложенныйЗапрос.Календарь,
	ВложенныйЗапрос.ДатаНачала,
	ВложенныйЗапрос.ДатаОкончания
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втГрафики
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	РазностиДат.Календарь КАК Календарь,
	РазностиДат.ДатаНачала КАК ДатаНачала,
	РазностиДат.КоличествоДней КАК КоличествоДней,
	МАКСИМУМ(РазностиДат.ДатаОкончания) КАК ДатаОкончания
ПОМЕСТИТЬ втРазностиДатСМаксимальнойДатой
ИЗ
	втРазностиДат КАК РазностиДат

СГРУППИРОВАТЬ ПО
	РазностиДат.Календарь,
	РазностиДат.ДатаНачала,
	РазностиДат.КоличествоДней
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втРазностиДат
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	втРеализацииСоСдвигом.АналитикаУчетаПоПартнерам КАК АналитикаУчетаПоПартнерам,
	втРеализацииСоСдвигом.Реализация КАК Реализация,
	втРеализацииСоСдвигом.СуммаДокумента КАК СуммаДокумента,
	втРеализацииСоСдвигом.Период КАК Период,
	втРеализацииСоСдвигом.СуммаОплачено КАК СуммаОплачено,
	СУММА(втРеализацииСоСдвигом.СуммаЭтапа) КАК СуммаЭтапов,
	МАКСИМУМ(ЕСТЬNULL(РазностиДат.ДатаОкончания, ВЫБОР
				КОГДА втРеализацииСоСдвигом.ДатаПлатежа = ДАТАВРЕМЯ(1, 1, 1)
					ТОГДА ДОБАВИТЬКДАТЕ(втРеализацииСоСдвигом.Период, ДЕНЬ, втРеализацииСоСдвигом.Сдвиг)
				ИНАЧЕ втРеализацииСоСдвигом.ДатаПлатежа
			КОНЕЦ)) КАК ДатаОплатыПлан
ПОМЕСТИТЬ втОплатыПоэтапноПоРеализациям
ИЗ
	втРеализацииСоСдвигом КАК втРеализацииСоСдвигом
		ЛЕВОЕ СОЕДИНЕНИЕ втРазностиДатСМаксимальнойДатой КАК РазностиДат
		ПО втРеализацииСоСдвигом.Календарь = РазностиДат.Календарь
			И втРеализацииСоСдвигом.Сдвиг = РазностиДат.КоличествоДней
			И втРеализацииСоСдвигом.Период = РазностиДат.ДатаНачала

СГРУППИРОВАТЬ ПО
	втРеализацииСоСдвигом.АналитикаУчетаПоПартнерам,
	втРеализацииСоСдвигом.Реализация,
	втРеализацииСоСдвигом.Период,
	втРеализацииСоСдвигом.СуммаДокумента,
	втРеализацииСоСдвигом.СуммаОплачено
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втРеализацииСоСдвигом
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	втОплатыПоэтапноПоРеализациям.Реализация КАК Реализация,
	втОплатыПоэтапноПоРеализациям.СуммаДокумента КАК СуммаДокументаРеализации,
	ВЫРАЗИТЬ(втОплатыПоэтапноПоРеализациям.Период КАК ДАТА) КАК ПериодРеализации,
	втОплатыПоэтапноПоРеализациям.СуммаОплачено КАК СуммаОплаченоПоРеализации,
	втОплатыПоэтапноПоРеализациям.ДатаОплатыПлан КАК ДатаОплатыПланПоРеализации,
	ВыручкаИСебестоимостьПродажОбороты.Партия КАК Партия,
	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.Номенклатура КАК Номенклатура,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот) КАК СуммаВыручкиПоПартии,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот) КАК СебестоимостьПоПартии,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот) / СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) КАК СуммаВыручкиПоПартииЗаЕдиницу,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот) / СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) КАК СебестоимостьПоПартииЗаЕдиницу,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) КАК КоличествоПоПартии
ПОМЕСТИТЬ втПартииПоРеализациямВЗакрытомПериоде
ИЗ
	втОплатыПоэтапноПоРеализациям КАК втОплатыПоэтапноПоРеализациям
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(, &amp;Дата2, Регистратор, ) КАК ВыручкаИСебестоимостьПродажОбороты
		ПО втОплатыПоэтапноПоРеализациям.Реализация = ВыручкаИСебестоимостьПродажОбороты.Регистратор
ГДЕ
	ЕСТЬNULL(ВыручкаИСебестоимостьПродажОбороты.Партия, НЕОПРЕДЕЛЕНО) &lt;&gt; НЕОПРЕДЕЛЕНО
{ГДЕ
	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам.*}

СГРУППИРОВАТЬ ПО
	втОплатыПоэтапноПоРеализациям.Реализация,
	ВЫРАЗИТЬ(втОплатыПоэтапноПоРеализациям.Период КАК ДАТА),
	втОплатыПоэтапноПоРеализациям.ДатаОплатыПлан,
	ВыручкаИСебестоимостьПродажОбороты.Партия,
	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.Номенклатура,
	втОплатыПоэтапноПоРеализациям.СуммаДокумента,
	втОплатыПоэтапноПоРеализациям.СуммаОплачено

ИМЕЮЩИЕ
	СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) &lt;&gt; 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	втОплатыПоэтапноПоРеализациям.Реализация КАК Реализация,
	втОплатыПоэтапноПоРеализациям.СуммаДокумента КАК СуммаДокументаРеализации,
	втОплатыПоэтапноПоРеализациям.Период КАК ПериодРеализации,
	втОплатыПоэтапноПоРеализациям.СуммаОплачено КАК СуммаОплаченоПоРеализации,
	втОплатыПоэтапноПоРеализациям.ДатаОплатыПлан КАК ДатаОплатыПланПоРеализации,
	ЕСТЬNULL(ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.Номенклатура, НЕОПРЕДЕЛЕНО) КАК Номенклатура,
	СУММА(ЕСТЬNULL(ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот, 0)) / СУММА(ЕСТЬNULL(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот, 0)) КАК ВыручкаЗаЕдиницуПоНоменклатуре,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) КАК КоличествоПоРеализации
ПОМЕСТИТЬ втОплатыПоэтапноПоРеализациямИзОткрытогоПериода
ИЗ
	втОплатыПоэтапноПоРеализациям КАК втОплатыПоэтапноПоРеализациям
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(, &amp;Дата2, Регистратор, ) КАК ВыручкаИСебестоимостьПродажОбороты
		ПО втОплатыПоэтапноПоРеализациям.Реализация = ВыручкаИСебестоимостьПродажОбороты.Регистратор
ГДЕ
	ЕСТЬNULL(ВыручкаИСебестоимостьПродажОбороты.Партия, НЕОПРЕДЕЛЕНО) = НЕОПРЕДЕЛЕНО
{ГДЕ
	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаПоПартнерам.*}

СГРУППИРОВАТЬ ПО
	втОплатыПоэтапноПоРеализациям.Реализация,
	втОплатыПоэтапноПоРеализациям.Период,
	втОплатыПоэтапноПоРеализациям.ДатаОплатыПлан,
	ЕСТЬNULL(ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.Номенклатура, НЕОПРЕДЕЛЕНО),
	втОплатыПоэтапноПоРеализациям.СуммаДокумента,
	втОплатыПоэтапноПоРеализациям.СуммаОплачено

ИМЕЮЩИЕ
	СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) &lt;&gt; 0
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втОплатыПоэтапноПоРеализациям
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.Реализация КАК Реализация,
	втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.СуммаДокументаРеализации КАК СуммаДокументаРеализации,
	втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.ПериодРеализации КАК ПериодРеализации,
	втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.СуммаОплаченоПоРеализации КАК СуммаОплаченоПоРеализации,
	втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.ДатаОплатыПланПоРеализации КАК ДатаОплатыПланПоРеализации,
	втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.Номенклатура КАК Номенклатура,
	ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Партия, НЕОПРЕДЕЛЕНО) КАК Партия,
	ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Сумма, 0) КАК СебестоимостьПоПартии,
	втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.ВыручкаЗаЕдиницуПоНоменклатуре * ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Количество, 0) КАК СуммаВыручкиПоПартии,
	ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Количество, втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.КоличествоПоРеализации) КАК КоличествоПоПартии
ПОМЕСТИТЬ втПартииПоРеализациямВОткрытомПериоде
ИЗ
	втОплатыПоэтапноПоРеализациямИзОткрытогоПериода КАК втОплатыПоэтапноПоРеализациямИзОткрытогоПериода
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений._ДвиженияПоПартиямОриентировочно КАК _ДвиженияПоПартиямОриентировочно
		ПО втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.Номенклатура = _ДвиженияПоПартиямОриентировочно.Номенклатура
			И втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.Реализация = _ДвиженияПоПартиямОриентировочно.Документ
{ГДЕ
	втОплатыПоэтапноПоРеализациямИзОткрытогоПериода.Номенклатура.*}
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втОплатыПоэтапноПоРеализациямИзОткрытогоПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.Номенклатура КАК Номенклатура,
	ВыручкаИСебестоимостьПродажОбороты.Регистратор КАК Реализация,
	ВыручкаИСебестоимостьПродажОбороты.Период КАК ПериодРеализации,
	ВыручкаИСебестоимостьПродажОбороты.Партия КАК Партия,
	ВыручкаИСебестоимостьПродажОбороты.Период КАК ДатаОплатыПланПоРеализации,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот) КАК СуммаДокументаРеализации,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот) КАК СуммаОплаченоПоРеализации,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот) КАК СуммаВыручкиПоПартии,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот) КАК СебестоимостьПоПартии,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) КАК КоличествоПоПартии,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СуммаВыручкиОборот) / СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) КАК СуммаВыручкиПоПартииЗаЕдиницу,
	СУММА(ВыручкаИСебестоимостьПродажОбороты.СтоимостьОборот) / СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) КАК СебестоимостьПоПартииЗаЕдиницу
ПОМЕСТИТЬ втВсеПартииПоРозничнымПродажам
ИЗ
	РегистрНакопления.ВыручкаИСебестоимостьПродаж.Обороты(&amp;Дата1, &amp;Дата2, Регистратор, ) КАК ВыручкаИСебестоимостьПродажОбороты
ГДЕ
	ВыручкаИСебестоимостьПродажОбороты.Регистратор ССЫЛКА Документ.ОтчетОРозничныхПродажах
{ГДЕ
	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.Номенклатура.* КАК Номенклатура,
	ВыручкаИСебестоимостьПродажОбороты.Период КАК ПериодРеализации,
	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.*}

СГРУППИРОВАТЬ ПО
	ВыручкаИСебестоимостьПродажОбороты.АналитикаУчетаНоменклатуры.Номенклатура,
	ВыручкаИСебестоимостьПродажОбороты.Регистратор,
	ВыручкаИСебестоимостьПродажОбороты.Период,
	ВыручкаИСебестоимостьПродажОбороты.Партия,
	ВыручкаИСебестоимостьПродажОбороты.Период

ИМЕЮЩИЕ
	СУММА(ВыручкаИСебестоимостьПродажОбороты.КоличествоОборот) &lt;&gt; 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	втВсеПартииПоРозничнымПродажам.Номенклатура КАК Номенклатура,
	втВсеПартииПоРозничнымПродажам.Реализация КАК Реализация,
	втВсеПартииПоРозничнымПродажам.ПериодРеализации КАК ПериодРеализации,
	втВсеПартииПоРозничнымПродажам.ДатаОплатыПланПоРеализации КАК ДатаОплатыПланПоРеализации,
	втВсеПартииПоРозничнымПродажам.СуммаДокументаРеализации КАК СуммаДокументаРеализации,
	втВсеПартииПоРозничнымПродажам.СуммаОплаченоПоРеализации КАК СуммаОплаченоПоРеализации,
	ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Партия, втВсеПартииПоРозничнымПродажам.Партия) КАК Партия,
	ВЫБОР
		КОГДА _ДвиженияПоПартиямОриентировочно.Партия ЕСТЬ NULL
			ТОГДА втВсеПартииПоРозничнымПродажам.СебестоимостьПоПартии
		ИНАЧЕ втВсеПартииПоРозничнымПродажам.СебестоимостьПоПартииЗаЕдиницу * ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Количество, 0)
	КОНЕЦ КАК СебестоимостьПоПартии,
	ВЫБОР
		КОГДА _ДвиженияПоПартиямОриентировочно.Партия ЕСТЬ NULL
			ТОГДА втВсеПартииПоРозничнымПродажам.СуммаВыручкиПоПартии
		ИНАЧЕ втВсеПартииПоРозничнымПродажам.СуммаВыручкиПоПартииЗаЕдиницу * ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Количество, 0)
	КОНЕЦ КАК СуммаВыручкиПоПартии,
	ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Количество, втВсеПартииПоРозничнымПродажам.КоличествоПоПартии) КАК КоличествоПоПартии,
	втВсеПартииПоРозничнымПродажам.СебестоимостьПоПартииЗаЕдиницу КАК СебестоимостьПоПартииЗаЕдиницу,
	втВсеПартииПоРозничнымПродажам.СуммаВыручкиПоПартииЗаЕдиницу КАК СуммаВыручкиПоПартииЗаЕдиницу
ПОМЕСТИТЬ втПартииПоРозничнымПродажам
ИЗ
	втВсеПартииПоРозничнымПродажам КАК втВсеПартииПоРозничнымПродажам
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений._ДвиженияПоПартиямОриентировочно КАК _ДвиженияПоПартиямОриентировочно
		ПО втВсеПартииПоРозничнымПродажам.Номенклатура = _ДвиженияПоПартиямОриентировочно.Номенклатура
			И втВсеПартииПоРозничнымПродажам.Реализация = _ДвиженияПоПартиямОриентировочно.Документ
			И (_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия = НЕОПРЕДЕЛЕНО)
{ГДЕ
	втВсеПартииПоРозничнымПродажам.Номенклатура.*}
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втВсеПартииПоРозничнымПродажам
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	втПартииПоРеализациям.Реализация КАК Реализация,
	втПартииПоРеализациям.СуммаДокументаРеализации КАК СуммаДокументаРеализации,
	ВЫРАЗИТЬ(втПартииПоРеализациям.ПериодРеализации КАК ДАТА) КАК ПериодРеализации,
	втПартииПоРеализациям.СуммаОплаченоПоРеализации КАК СуммаОплаченоПоРеализации,
	втПартииПоРеализациям.СуммаОплаченоПоРеализации / втПартииПоРеализациям.СуммаДокументаРеализации * 100 КАК ДоляОплаченоПоРеализации,
	ВЫРАЗИТЬ(втПартииПоРеализациям.ДатаОплатыПланПоРеализации КАК ДАТА) КАК ДатаОплатыПланПоРеализации,
	ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия, втПартииПоРеализациям.Партия) КАК Партия,
	ВЫРАЗИТЬ(ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия, втПартииПоРеализациям.Партия) КАК Документ.ПриобретениеТоваровУслуг).Партнер КАК Поставщик,
	ВЫРАЗИТЬ(ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия, втПартииПоРеализациям.Партия) КАК Документ.ПриобретениеТоваровУслуг).СуммаДокумента КАК СуммаПоставки,
	втПартииПоРеализациям.Номенклатура КАК Номенклатура,
	ВЫБОР
		КОГДА _ДвиженияПоПартиямОриентировочно.Партия ЕСТЬ NULL
			ТОГДА втПартииПоРеализациям.СуммаВыручкиПоПартии
		ИНАЧЕ _ДвиженияПоПартиямОриентировочно.Количество * втПартииПоРеализациям.СуммаВыручкиПоПартииЗаЕдиницу
	КОНЕЦ КАК СуммаВыручкиПоПартии,
	ВЫБОР
		КОГДА _ДвиженияПоПартиямОриентировочно.Партия ЕСТЬ NULL
			ТОГДА втПартииПоРеализациям.СебестоимостьПоПартии
		ИНАЧЕ _ДвиженияПоПартиямОриентировочно.Количество * втПартииПоРеализациям.СебестоимостьПоПартииЗаЕдиницу
	КОНЕЦ КАК СебестоимостьПоПартии,
	ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Количество, втПартииПоРеализациям.КоличествоПоПартии) КАК КоличествоПоПартии
ПОМЕСТИТЬ втРезультатСоВсемиПартиями
ИЗ
	втПартииПоРеализациямВЗакрытомПериоде КАК втПартииПоРеализациям
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений._ДвиженияПоПартиямОриентировочно КАК _ДвиженияПоПартиямОриентировочно
		ПО втПартииПоРеализациям.Номенклатура = _ДвиженияПоПартиямОриентировочно.Номенклатура
			И втПартииПоРеализациям.Реализация = _ДвиженияПоПартиямОриентировочно.Документ
			И втПартииПоРеализациям.Партия = _ДвиженияПоПартиямОриентировочно.Партия
			И (_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия &lt;&gt; НЕОПРЕДЕЛЕНО)
{ГДЕ
	(ВЫРАЗИТЬ(ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия, втПартииПоРеализациям.Партия) КАК Документ.ПриобретениеТоваровУслуг).Партнер) КАК Поставщик,
	втПартииПоРеализациям.Номенклатура.*}

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	втПартииПоРеализациям.Реализация,
	втПартииПоРеализациям.СуммаДокументаРеализации,
	ВЫРАЗИТЬ(втПартииПоРеализациям.ПериодРеализации КАК ДАТА),
	втПартииПоРеализациям.СуммаОплаченоПоРеализации,
	втПартииПоРеализациям.СуммаОплаченоПоРеализации / втПартииПоРеализациям.СуммаДокументаРеализации * 100,
	ВЫРАЗИТЬ(втПартииПоРеализациям.ДатаОплатыПланПоРеализации КАК ДАТА),
	втПартииПоРеализациям.Партия,
	ВЫРАЗИТЬ(втПартииПоРеализациям.Партия КАК Документ.ПриобретениеТоваровУслуг).Партнер,
	ВЫРАЗИТЬ(втПартииПоРеализациям.Партия КАК Документ.ПриобретениеТоваровУслуг).СуммаДокумента,
	втПартииПоРеализациям.Номенклатура,
	втПартииПоРеализациям.СуммаВыручкиПоПартии,
	втПартииПоРеализациям.СебестоимостьПоПартии,
	втПартииПоРеализациям.КоличествоПоПартии
ИЗ
	втПартииПоРеализациямВОткрытомПериоде КАК втПартииПоРеализациям
{ГДЕ
	(ВЫРАЗИТЬ(втПартииПоРеализациям.Партия КАК Документ.ПриобретениеТоваровУслуг).Партнер) КАК Поставщик}

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	втПартииПоРозничнымПродажам.Реализация,
	втПартииПоРозничнымПродажам.СуммаДокументаРеализации,
	втПартииПоРозничнымПродажам.ПериодРеализации,
	втПартииПоРозничнымПродажам.СуммаОплаченоПоРеализации,
	100,
	втПартииПоРозничнымПродажам.ДатаОплатыПланПоРеализации,
	ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия, втПартииПоРозничнымПродажам.Партия),
	ВЫРАЗИТЬ(ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия, втПартииПоРозничнымПродажам.Партия) КАК Документ.ПриобретениеТоваровУслуг).Партнер,
	ВЫРАЗИТЬ(ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия, втПартииПоРозничнымПродажам.Партия) КАК Документ.ПриобретениеТоваровУслуг).СуммаДокумента,
	втПартииПоРозничнымПродажам.Номенклатура,
	ВЫБОР
		КОГДА _ДвиженияПоПартиямОриентировочно.Партия ЕСТЬ NULL
			ТОГДА втПартииПоРозничнымПродажам.СуммаВыручкиПоПартии
		ИНАЧЕ _ДвиженияПоПартиямОриентировочно.Количество * втПартииПоРозничнымПродажам.СуммаВыручкиПоПартииЗаЕдиницу
	КОНЕЦ,
	ВЫБОР
		КОГДА _ДвиженияПоПартиямОриентировочно.Партия ЕСТЬ NULL
			ТОГДА втПартииПоРозничнымПродажам.СебестоимостьПоПартии
		ИНАЧЕ _ДвиженияПоПартиямОриентировочно.Количество * втПартииПоРозничнымПродажам.СебестоимостьПоПартииЗаЕдиницу
	КОНЕЦ,
	ЕСТЬNULL(_ДвиженияПоПартиямОриентировочно.Количество, втПартииПоРозничнымПродажам.КоличествоПоПартии)
ИЗ
	втПартииПоРозничнымПродажам КАК втПартииПоРозничнымПродажам
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений._ДвиженияПоПартиямОриентировочно КАК _ДвиженияПоПартиямОриентировочно
		ПО втПартииПоРозничнымПродажам.Номенклатура = _ДвиженияПоПартиямОриентировочно.Номенклатура
			И втПартииПоРозничнымПродажам.Реализация = _ДвиженияПоПартиямОриентировочно.Документ
			И втПартииПоРозничнымПродажам.Партия = _ДвиженияПоПартиямОриентировочно.Партия
			И (_ДвиженияПоПартиямОриентировочно.ВторичнаяПартия &lt;&gt; НЕОПРЕДЕЛЕНО)
{ГДЕ
	(ВЫРАЗИТЬ(втПартииПоРозничнымПродажам.Партия КАК Документ.ПриобретениеТоваровУслуг).Партнер) КАК Поставщик}
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втПартииПоРеализациямВЗакрытомПериоде
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втПартииПоРеализациямВОткрытомПериоде
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втПартииПоРозничнымПродажам
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	РеквизитыИСведения.Партия КАК Партия,
	МАКСИМУМ(РеквизитыИСведения.ИнвестиционныйПроект) КАК ИнвестиционныйПроект
ПОМЕСТИТЬ втИнвестиционныеПартии
ИЗ
	(ВЫБРАТЬ
		ДополнительныеРеквизиты.Ссылка КАК Партия,
		ДополнительныеРеквизиты.Значение КАК ИнвестиционныйПроект
	ИЗ
		Документ.ПриобретениеТоваровУслуг.ДополнительныеРеквизиты КАК ДополнительныеРеквизиты
	ГДЕ
		ДополнительныеРеквизиты.Свойство = &amp;ИнвестиционныйПроект
		И ДополнительныеРеквизиты.Значение &lt;&gt; &amp;ПустойПроект
		И ДополнительныеРеквизиты.Значение &lt;&gt; НЕОПРЕДЕЛЕНО
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ РАЗЛИЧНЫЕ
		ДополнительныеСведения.Объект,
		ДополнительныеСведения.Значение
	ИЗ
		РегистрСведений.ДополнительныеСведения КАК ДополнительныеСведения
	ГДЕ
		ДополнительныеСведения.Свойство = &amp;ИнвестиционныйПроект
		И ДополнительныеСведения.Значение &lt;&gt; &amp;ПустойПроект
		И ДополнительныеСведения.Значение &lt;&gt; НЕОПРЕДЕЛЕНО) КАК РеквизитыИСведения

СГРУППИРОВАТЬ ПО
	РеквизитыИСведения.Партия

ИНДЕКСИРОВАТЬ ПО
	Партия
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	втРезультатСоВсемиПартиями.Реализация КАК Реализация,
	втРезультатСоВсемиПартиями.СуммаДокументаРеализации КАК СуммаДокументаРеализации,
	втРезультатСоВсемиПартиями.ПериодРеализации КАК ПериодРеализации,
	втРезультатСоВсемиПартиями.СуммаОплаченоПоРеализации КАК СуммаОплаченоПоРеализации,
	втРезультатСоВсемиПартиями.ДоляОплаченоПоРеализации КАК ДоляОплаченоПоРеализации,
	втРезультатСоВсемиПартиями.ДатаОплатыПланПоРеализации КАК ДатаОплатыПланПоРеализации,
	втРезультатСоВсемиПартиями.Партия КАК Партия,
	втИнвестиционныеПартии.ИнвестиционныйПроект КАК ИнвестиционныйПроект,
	втРезультатСоВсемиПартиями.Поставщик КАК Поставщик,
	втРезультатСоВсемиПартиями.СуммаПоставки КАК СуммаПоставки,
	втРезультатСоВсемиПартиями.Номенклатура КАК Номенклатура,
	втРезультатСоВсемиПартиями.СуммаВыручкиПоПартии КАК СуммаВыручкиПоПартии,
	втРезультатСоВсемиПартиями.СебестоимостьПоПартии КАК СебестоимостьПоПартии,
	втРезультатСоВсемиПартиями.КоличествоПоПартии КАК КоличествоПоПартии
ПОМЕСТИТЬ втРезультат
ИЗ
	втРезультатСоВсемиПартиями КАК втРезультатСоВсемиПартиями
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втИнвестиционныеПартии КАК втИнвестиционныеПартии
		ПО втРезультатСоВсемиПартиями.Партия = втИнвестиционныеПартии.Партия
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втРезультатСоВсемиПартиями
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	втРезультат.Партия КАК Партия,
	втРезультат.Номенклатура КАК Номенклатура
ПОМЕСТИТЬ втВсеПартииНоменклатуры
ИЗ
	втРезультат КАК втРезультат
ГДЕ
	&amp;ПолучатьЦенуПартии
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СебестоимостьТоваровОбороты.АналитикаУчетаНоменклатуры.Номенклатура КАК Номенклатура,
	СебестоимостьТоваровОбороты.Партия КАК Партия,
	СУММА(СебестоимостьТоваровОбороты.СтоимостьОборот) / СУММА(СебестоимостьТоваровОбороты.КоличествоОборот) КАК ЦенаПартии
ПОМЕСТИТЬ втЦеныПоПартиям
ИЗ
	РегистрНакопления.СебестоимостьТоваров.Обороты(, , Регистратор, ) КАК СебестоимостьТоваровОбороты
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втВсеПартииНоменклатуры КАК втВсеПартииНоменклатуры
		ПО СебестоимостьТоваровОбороты.Партия = втВсеПартииНоменклатуры.Партия
			И СебестоимостьТоваровОбороты.АналитикаУчетаНоменклатуры.Номенклатура = втВсеПартииНоменклатуры.Номенклатура
			И СебестоимостьТоваровОбороты.Регистратор = втВсеПартииНоменклатуры.Партия

СГРУППИРОВАТЬ ПО
	СебестоимостьТоваровОбороты.АналитикаУчетаНоменклатуры.Номенклатура,
	СебестоимостьТоваровОбороты.Партия

ИМЕЮЩИЕ
	СУММА(СебестоимостьТоваровОбороты.КоличествоОборот) &lt;&gt; 0
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ втВсеПартииНоменклатуры
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	втРезультат.Реализация КАК Реализация,
	втРезультат.СуммаДокументаРеализации КАК СуммаДокументаРеализации,
	втРезультат.ПериодРеализации КАК ПериодРеализации,
	втРезультат.СуммаОплаченоПоРеализации КАК СуммаОплаченоПоРеализации,
	втРезультат.ДоляОплаченоПоРеализации КАК ДоляОплаченоПоРеализации,
	втРезультат.ДатаОплатыПланПоРеализации КАК ДатаОплатыПланПоРеализации,
	втРезультат.Партия КАК Партия,
	втРезультат.Поставщик КАК Поставщик,
	втРезультат.СуммаПоставки КАК СуммаПоставки,
	втРезультат.Номенклатура КАК Номенклатура,
	втРезультат.СуммаВыручкиПоПартии КАК СуммаВыручкиПоПартии,
	ВЫБОР
		КОГДА втЦеныПоПартиям.Партия ЕСТЬ NULL
			ТОГДА втРезультат.СебестоимостьПоПартии
		ИНАЧЕ втЦеныПоПартиям.ЦенаПартии * втРезультат.КоличествоПоПартии
	КОНЕЦ КАК СебестоимостьПоПартии,
	втРезультат.СуммаВыручкиПоПартии * втРезультат.СуммаОплаченоПоРеализации / втРезультат.СуммаДокументаРеализации КАК СуммаОплаченоПоПартии,
	втРезультат.ИнвестиционныйПроект КАК ИнвестиционныйПроект,
	втРезультат.КоличествоПоПартии КАК КоличествоПоПартии
{ВЫБРАТЬ
	Реализация,
	СуммаДокументаРеализации,
	ПериодРеализации,
	СуммаОплаченоПоРеализации,
	ДоляОплаченоПоРеализации,
	ДатаОплатыПланПоРеализации,
	Партия,
	Поставщик,
	СуммаПоставки,
	Номенклатура.*,
	СуммаВыручкиПоПартии,
	СебестоимостьПоПартии,
	КоличествоПоПартии,
	СуммаОплаченоПоПартии,
	ИнвестиционныйПроект.*}
ИЗ
	втРезультат КАК втРезультат
		ЛЕВОЕ СОЕДИНЕНИЕ втЦеныПоПартиям КАК втЦеныПоПартиям
		ПО втРезультат.Партия = втЦеныПоПартиям.Партия
			И втРезультат.Номенклатура = втЦеныПоПартиям.Номенклатура
			И (&amp;ПолучатьЦенуПартии)
{ГДЕ
	втРезультат.ИнвестиционныйПроект,
	втРезультат.ДоляОплаченоПоРеализации,
	втРезультат.ДатаОплатыПланПоРеализации,
	втРезультат.Партия.*,
	втРезультат.Поставщик.*,
	втРезультат.Номенклатура.*}</query>
			<autoFillFields>false</autoFillFields>
		</dataSet>
		<calculatedField>
			<dataPath>ЦенаПоПартии</dataPath>
			<expression>выбор когда КоличествоПоПартии=0 тогда 0 иначе СебестоимостьПоПартии/КоличествоПоПартии конец</expression>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Стоимость партии за единицу</d4p1:content>
				</d4p1:item>
			</title>
			<appearance>
				<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
					<parameter>Формат</parameter>
					<value xmlns:d6p1="http://v8.1c.ru/8.1/data/core" xsi:type="d6p1:LocalStringType">
						<d6p1:item>
							<d6p1:lang>ru</d6p1:lang>
							<d6p1:content>ЧДЦ=2</d6p1:content>
						</d6p1:item>
					</value>
				</item>
			</appearance>
		</calculatedField>
		<calculatedField>
			<dataPath>ОплаченнаяСебестоимость</dataPath>
			<expression>СебестоимостьПоПартии * ДоляОплаченоПоРеализации/100</expression>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Оплаченная себестоимость</d4p1:content>
				</d4p1:item>
			</title>
			<appearance>
				<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
					<parameter>Формат</parameter>
					<value xmlns:d6p1="http://v8.1c.ru/8.1/data/core" xsi:type="d6p1:LocalStringType">
						<d6p1:item>
							<d6p1:lang>ru</d6p1:lang>
							<d6p1:content>ЧДЦ=2</d6p1:content>
						</d6p1:item>
					</value>
				</item>
			</appearance>
		</calculatedField>
		<totalField>
			<dataPath>СуммаВыручкиПоПартии</dataPath>
			<expression>Сумма(СуммаВыручкиПоПартии)</expression>
		</totalField>
		<totalField>
			<dataPath>СуммаОплаченоПоПартии</dataPath>
			<expression>Сумма(СуммаОплаченоПоПартии)</expression>
		</totalField>
		<totalField>
			<dataPath>СебестоимостьПоПартии</dataPath>
			<expression>Сумма(СебестоимостьПоПартии)</expression>
		</totalField>
		<totalField>
			<dataPath>КоличествоПоПартии</dataPath>
			<expression>Сумма(КоличествоПоПартии)</expression>
		</totalField>
		<totalField>
			<dataPath>ОплаченнаяСебестоимость</dataPath>
			<expression>Сумма(ОплаченнаяСебестоимость)</expression>
		</totalField>
		<totalField>
			<dataPath>ЦенаПоПартии</dataPath>
			<expression>Среднее(ЦенаПоПартии)</expression>
			<group>Номенклатура</group>
		</totalField>
		<parameter>
			<name>ПериодОтчета</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Выборка оплат за период</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">StandardPeriod</Type>
			</valueType>
			<value xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:StandardPeriod">
				<d4p1:variant xsi:type="d4p1:StandardPeriodVariant">Custom</d4p1:variant>
				<d4p1:startDate>0001-01-01T00:00:00</d4p1:startDate>
				<d4p1:endDate>0001-01-01T00:00:00</d4p1:endDate>
			</value>
			<useRestriction>false</useRestriction>
			<use>Always</use>
		</parameter>
		<parameter>
			<name>Дата1</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Дата1</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
			<expression>&amp;ПериодОтчета.ДатаНачала</expression>
		</parameter>
		<parameter>
			<name>Дата2</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Дата2</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
			<expression>&amp;ПериодОтчета.ДатаОкончания</expression>
		</parameter>
		<parameter>
			<name>ИнвестиционныйПроект</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Реквизит "Инвестиционный проект"</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<TypeId xmlns="http://v8.1c.ru/8.1/data/core">824d87c6-28dc-46eb-93d6-fbbcb5c9ab24</TypeId>
			</valueType>
			<value xsi:nil="true"/>
			<useRestriction>true</useRestriction>
			<use>Always</use>
		</parameter>
		<parameter>
			<name>ИспользоватьГрафикОплатыИзСоглашенияСКлиентом</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Использовать график оплаты из соглашения с клиентом</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:boolean</Type>
			</valueType>
			<value xsi:type="xs:boolean">true</value>
			<useRestriction>false</useRestriction>
			<use>Always</use>
		</parameter>
		<parameter>
			<name>ПоНакладным</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>По накладным</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<TypeId xmlns="http://v8.1c.ru/8.1/data/core">b1bcfacd-dda8-4041-8278-6f0d25af4fb0</TypeId>
			</valueType>
			<value xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xsi:type="dcscor:DesignTimeValue">Перечисление.ПорядокРасчетов.ПоНакладным</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>ГрафикНеЗаполнен</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>График не заполнен</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<TypeId xmlns="http://v8.1c.ru/8.1/data/core">90feabf1-6e48-4daf-b9de-f19f27bf20f3</TypeId>
			</valueType>
			<value xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xsi:type="dcscor:DesignTimeValue">Справочник.ГрафикиОплаты.ПустаяСсылка</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<parameter>
			<name>НеПересчитыватьОриентировочныеДвиженияПоПартиям</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Отказаться от пересчета ориентировочных движений по партиям</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:boolean</Type>
			</valueType>
			<value xsi:type="xs:boolean">false</value>
			<useRestriction>false</useRestriction>
			<use>Always</use>
		</parameter>
		<parameter>
			<name>ПолучатьЦенуПартии</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Получать с/ст из документа поступления</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:boolean</Type>
			</valueType>
			<value xsi:type="xs:boolean">true</value>
			<useRestriction>false</useRestriction>
			<use>Always</use>
		</parameter>
		<parameter>
			<name>ПустойПроект</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Пустой проект</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<TypeId xmlns="http://v8.1c.ru/8.1/data/core">e43b25dc-c8ff-4d76-bc32-fbe9644fb6e8</TypeId>
			</valueType>
			<value xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xsi:type="dcscor:DesignTimeValue">Справочник.Проекты.ПустаяСсылка</value>
			<useRestriction>true</useRestriction>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">ОплатыОтКлиентовПоИнвестиционнымПроектам</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>&lt;АМ&gt; Оплата от клиентов по инвестиционным проектам (3.7)</d4p1:content>
				</d4p1:item>
			</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<selection>
		<item xsi:type="SelectedItemField">
			<field>СебестоимостьПоПартии</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>СуммаВыручкиПоПартии</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>СуммаОплаченоПоПартии</field>
		</item>
		<item xsi:type="SelectedItemField">
			<field>ОплаченнаяСебестоимость</field>
		</item>
		<viewMode>Normal</viewMode>
		<userSettingID>3e9e1ef3-a43e-4138-9437-f77836fa0af2</userSettingID>
	</selection>
	<filter>
		<item xsi:type="FilterItemComparison">
			<use>false</use>
			<left xsi:type="dcscor:Field">ИнвестиционныйПроект</left>
			<comparisonType>Equal</comparisonType>
			<right xsi:type="dcscor:DesignTimeValue">Справочник.Проекты.ПустаяСсылка</right>
			<viewMode>Normal</viewMode>
			<userSettingID>5d73c0db-92a9-4c81-a54a-cb82c3b32aad</userSettingID>
		</item>
		<item xsi:type="FilterItemComparison">
			<use>false</use>
			<left xsi:type="dcscor:Field">Поставщик</left>
			<comparisonType>Equal</comparisonType>
			<right xsi:type="dcscor:DesignTimeValue">Справочник.Партнеры.ПустаяСсылка</right>
			<viewMode>Normal</viewMode>
			<userSettingID>c7a25779-7798-445c-8d66-bdde064261bd</userSettingID>
		</item>
		<item xsi:type="FilterItemComparison">
			<use>false</use>
			<left xsi:type="dcscor:Field">Номенклатура</left>
			<comparisonType>Equal</comparisonType>
			<right xsi:type="dcscor:DesignTimeValue">Справочник.Номенклатура.ПустаяСсылка</right>
			<viewMode>Normal</viewMode>
			<userSettingID>38270b69-2776-4117-bba4-945b730a4a24</userSettingID>
		</item>
		<item xsi:type="FilterItemComparison">
			<use>false</use>
			<left xsi:type="dcscor:Field">ДоляОплаченоПоРеализации</left>
			<comparisonType>GreaterOrEqual</comparisonType>
			<right xsi:type="xs:decimal">100</right>
		</item>
		<userSettingID>0fadc0f5-2d14-421f-99ee-5d467ddb8320</userSettingID>
	</filter>
	<dataParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>ПериодОтчета</dcscor:parameter>
			<dcscor:value xsi:type="v8:StandardPeriod">
				<v8:variant xsi:type="v8:StandardPeriodVariant">LastMonth</v8:variant>
			</dcscor:value>
			<userSettingID>1279b566-2ab1-4a8b-8a35-32c3b9d65591</userSettingID>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>ИнвестиционныйПроект</dcscor:parameter>
			<dcscor:value xsi:nil="true"/>
			<userSettingID>8135ebbf-23f5-467c-98a4-e2d16dd4da09</userSettingID>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>ИспользоватьГрафикОплатыИзСоглашенияСКлиентом</dcscor:parameter>
			<dcscor:value xsi:type="xs:boolean">true</dcscor:value>
			<viewMode>Normal</viewMode>
			<userSettingID>a6741904-5a79-41da-88a0-368e4424eb60</userSettingID>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>ПоНакладным</dcscor:parameter>
			<dcscor:value xsi:nil="true"/>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>ГрафикНеЗаполнен</dcscor:parameter>
			<dcscor:value xsi:nil="true"/>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>НеПересчитыватьОриентировочныеДвиженияПоПартиям</dcscor:parameter>
			<dcscor:value xsi:type="xs:boolean">false</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>ПолучатьЦенуПартии</dcscor:parameter>
			<dcscor:value xsi:type="xs:boolean">true</dcscor:value>
		</dcscor:item>
	</dataParameters>
	<order>
		<viewMode>Normal</viewMode>
		<userSettingID>4c665228-4bd9-41b8-9777-bb12abf73a3f</userSettingID>
	</order>
	<conditionalAppearance>
		<item>
			<selection>
				<item>
					<field>Партия</field>
				</item>
			</selection>
			<filter>
				<item xsi:type="FilterItemComparison">
					<left xsi:type="dcscor:Field">СебестоимостьПоПартии</left>
					<comparisonType>Equal</comparisonType>
					<right xsi:type="xs:decimal">0</right>
				</item>
			</filter>
			<appearance>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>ЦветТекста</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:Color">style:NegativeTextColor</dcscor:value>
				</dcscor:item>
			</appearance>
		</item>
		<item>
			<selection>
				<item>
					<field>СуммаВыручкиПоПартии</field>
				</item>
				<item>
					<field>СебестоимостьПоПартии</field>
				</item>
			</selection>
			<filter>
				<item xsi:type="FilterItemComparison">
					<left xsi:type="dcscor:Field">СебестоимостьПоПартии</left>
					<comparisonType>GreaterOrEqual</comparisonType>
					<right xsi:type="dcscor:Field">СуммаВыручкиПоПартии</right>
				</item>
			</filter>
			<appearance>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>ЦветТекста</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:Color">style:NegativeTextColor</dcscor:value>
				</dcscor:item>
			</appearance>
		</item>
		<item>
			<selection>
				<item>
					<field>Реализация</field>
				</item>
				<item>
					<field>ДоляОплаченоПоРеализации</field>
				</item>
				<item>
					<field>СуммаОплаченоПоРеализации</field>
				</item>
			</selection>
			<filter>
				<item xsi:type="FilterItemComparison">
					<left xsi:type="dcscor:Field">ДоляОплаченоПоРеализации</left>
					<comparisonType>Less</comparisonType>
					<right xsi:type="xs:decimal">100</right>
				</item>
			</filter>
			<appearance>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>ЦветТекста</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:Color">style:NegativeTextColor</dcscor:value>
				</dcscor:item>
			</appearance>
		</item>
		<item>
			<selection>
				<item>
					<field>СуммаОплаченоПоПартии</field>
				</item>
			</selection>
			<filter>
				<item xsi:type="FilterItemComparison">
					<left xsi:type="dcscor:Field">СуммаОплаченоПоПартии</left>
					<comparisonType>Less</comparisonType>
					<right xsi:type="dcscor:Field">СуммаВыручкиПоПартии</right>
				</item>
			</filter>
			<appearance>
				<dcscor:item xsi:type="SettingsParameterValue">
					<dcscor:parameter>ЦветТекста</dcscor:parameter>
					<dcscor:value xsi:type="v8ui:Color">style:NegativeTextColor</dcscor:value>
				</dcscor:item>
			</appearance>
		</item>
		<viewMode>Normal</viewMode>
		<userSettingID>57801971-b982-490a-ba67-7be7be935438</userSettingID>
	</conditionalAppearance>
	<outputParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>РасположениеГруппировки</dcscor:parameter>
			<dcscor:value xsi:type="DataCompositionGroupPlacement">None</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>РасположениеРеквизитов</dcscor:parameter>
			<dcscor:value xsi:type="DataCompositionAttributesPlacement">SpecialPosition</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>ГоризонтальноеРасположениеОбщихИтогов</dcscor:parameter>
			<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>ВертикальноеРасположениеОбщихИтогов</dcscor:parameter>
			<dcscor:value xsi:type="dcscor:DataCompositionTotalPlacement">None</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>ВыводитьЗаголовок</dcscor:parameter>
			<dcscor:value xsi:type="DataCompositionTextOutputType">Output</dcscor:value>
		</dcscor:item>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:use>false</dcscor:use>
			<dcscor:parameter>Заголовок</dcscor:parameter>
			<dcscor:value xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Оплата от клиентов по инвестиционным проектам</v8:content>
				</v8:item>
			</dcscor:value>
		</dcscor:item>
	</outputParameters>
	<item xsi:type="StructureItemGroup">
		<groupItems>
			<item xsi:type="GroupItemField">
				<field>ИнвестиционныйПроект</field>
				<groupType>Items</groupType>
				<periodAdditionType>None</periodAdditionType>
				<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
				<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
			</item>
		</groupItems>
		<order>
			<item xsi:type="OrderItemAuto"/>
		</order>
		<selection>
			<item xsi:type="SelectedItemAuto"/>
		</selection>
		<outputParameters/>
		<item xsi:type="StructureItemGroup">
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Партия</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
				<item xsi:type="GroupItemField">
					<field>Поставщик</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
				<item xsi:type="GroupItemField">
					<field>СуммаПоставки</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
			<outputParameters/>
			<item xsi:type="StructureItemGroup">
				<groupItems>
					<item xsi:type="GroupItemField">
						<field>Номенклатура</field>
						<groupType>Items</groupType>
						<periodAdditionType>None</periodAdditionType>
						<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
						<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
					</item>
				</groupItems>
				<order>
					<item xsi:type="OrderItemAuto"/>
				</order>
				<selection>
					<item xsi:type="SelectedItemAuto"/>
					<item xsi:type="SelectedItemField">
						<field>КоличествоПоПартии</field>
					</item>
					<item xsi:type="SelectedItemField">
						<field>ЦенаПоПартии</field>
					</item>
				</selection>
				<outputParameters/>
				<item xsi:type="StructureItemGroup">
					<groupItems>
						<item xsi:type="GroupItemField">
							<field>Реализация</field>
							<groupType>Items</groupType>
							<periodAdditionType>None</periodAdditionType>
							<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
							<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
						</item>
						<item xsi:type="GroupItemField">
							<field>ДоляОплаченоПоРеализации</field>
							<groupType>Items</groupType>
							<periodAdditionType>None</periodAdditionType>
							<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
							<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
						</item>
					</groupItems>
					<order>
						<item xsi:type="OrderItemAuto"/>
					</order>
					<selection>
						<item xsi:type="SelectedItemAuto"/>
					</selection>
					<outputParameters/>
					<item xsi:type="StructureItemGroup">
						<use>false</use>
						<order>
							<item xsi:type="OrderItemAuto"/>
						</order>
						<selection>
							<item xsi:type="SelectedItemAuto">
								<use>false</use>
							</item>
							<item xsi:type="SelectedItemField">
								<field>Номенклатура</field>
							</item>
							<item xsi:type="SelectedItemField">
								<field>КоличествоПоПартии</field>
							</item>
							<item xsi:type="SelectedItemField">
								<field>ЦенаПоПартии</field>
							</item>
						</selection>
						<outputParameters/>
					</item>
				</item>
			</item>
		</item>
	</item>
	<itemsViewMode>Normal</itemsViewMode>
	<itemsUserSettingID>076c3ff7-6dfd-4f34-96c1-01e0ec44dd35</itemsUserSettingID>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>